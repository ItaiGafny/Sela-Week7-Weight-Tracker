# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

pool:
  #removed, paralelism needed
  #vmImage: ubuntu-latest
  name: 'my-pool'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '14.x'
  displayName: 'Install Node.js'

#- script: |
#    npm install @hapi/hapi@19 @hapi/bell@12 @hapi/boom@9 @hapi/cookie@11 @hapi/inert@6 @hapi/joi@17 @hapi/vision@6 dotenv@8 ejs@3 postgres@1
#    npm --save-dev nodemon@2
#  displayName: 'npm install and build'

# Copy Files
- task: CopyFiles@2
  inputs:
    sourceFolder: $(Build.SourcesDirectory)
    contents: '*.zip' 
    targetFolder: $(Build.StagingDirectory)
- task: printAllVariables@1
  displayName: 'Print all variables'
  
- task: UniversalPackages@0
  displayName: Universal Publish
  inputs:
    command: publish
    publishDirectory: '$(Build.StagingDirectory)'
    vstsFeedPublish: 'WeightTracker/my-feed2'
    vstsFeedPackagePublish: 'my-artifact-yaml'
    packagePublishDescription: 'my-artifact description'
